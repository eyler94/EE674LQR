clc
clear

A_lat =[-7.76772583e-01/25  1.24982663e+00/25 -2.49687391e+01/25  9.79995917e+00/25 -1.70856859e-16/25;
       -3.86674768e+00 -2.26288507e+01  1.09050408e+01  0.00000000e+00  0.00000000e+00;
       7.83075106e-01 -1.15091677e-01 -1.22765474e+00  0.00000000e+00  0.00000000e+00;
       0.00000000e+00  9.99966585e-01  5.00522872e-02  0.00000000e+00  0.00000000e+00;
       0.00000000e+00 -1.67040911e-06  1.00121846e+00  0.00000000e+00  0.00000000e+00];
B_lat = [1.48617188/25   3.76496875/25;
        130.8836782  -1.79637437;
        5.01173501   -24.88134133;
        0.           0.        ;
        0.           0.        ];
Alat_aug = [A_lat zeros(5,2);
            -1 0 0 0 0 0 0;
            0 0 0 0 -1 0 0];
        
Blat_aug = [B_lat; 0 0; 0 0];

Clat_aug = [-1 0 0 0 0 0 0;
            0 0 0 0 -1 0 0];

D = [0,0;0,0];

betamax = pi/2
pmax = 1
qmax = 1
rmax = 1
phimax = pi/2
psimax = pi/2

Qlat = [1/betamax^2 0 0 0 0 0 0;
        0 1/pmax^2 0 0 0 0 0;
        0 0 1/rmax^2 0 0 0 0;
        0 0 0 1/phimax^2 0 0 0;
        0 0 0 0 1/psimax^2 0 0;
        0 0 0 0 0 1 0;
        0 0 0 0 0 0 1];
%eye(7);


damax = deg2rad(45)
drmax = deg2rad(45)
Rlat = [1/damax^2 0;
        0 1/drmax^2];
%eye(2);

[Klat, sa, ea] = lqr(Alat_aug,Blat_aug,Qlat,Rlat);

A_lon = [-0.57681981  0.48178674  -1.21990873  -9.78648014   0.;
        -0.56064823  -4.46355336  24.37104644  -0.56472816   0.;
        0.19994698   -3.99297803  -5.2947383    0.           0.;
        0.           0.           0.99971072   0.           0.;
        -0.04999304   0.99874957   0.         -25.00631447   0.];
B_lon = [-0.13839273  47.76297312;
        -2.58618378  0.        ;
        -36.11238957 0.        ;
        0.           0.        ;
        0.           0.        ];


Alon_aug = [A_lon zeros(5,2);
            -1 0 0 0 0 0 0;
            0 0 0 0 -1 0 0];

Blon_aug = [B_lon; 0 0; 0 0];

Clon_aug = [-1 0 0 0 0 0 0;
            0 0 0 0 -1 0 0];

D = [0,0;0,0];

Qlon = eye(7);

Rlon = eye(2);

[Klon, s, e] = lqr(Alon_aug,Blon_aug,Qlon,Rlon);

Klat
Klon
